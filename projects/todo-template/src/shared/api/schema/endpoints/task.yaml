schemas:
  Task:
    type: object
    required:
      - id
      - text
      - completed
      - priority
      - createdAt
    properties:
      id:
        type: string
        format: uuid
      text:
        type: string
      completed:
        type: boolean
        default: false
      createdAt:
        type: string
        format: date-time
      updatedAt:
        type: string
        format: date-time
        nullable: true

  TasksList:
    type: object
    required:
      - list
      - total
      - totalPages
    properties:
      list:
        type: array
        items:
          $ref: '#/schemas/Task'
      total:
        type: integer
      totalPages:
        type: integer
      currentPage:
        type: integer

parameters:
  taskId:
    in: path
    name: taskId
    required: true
    schema:
      type: string
      format: uuid
    description: ID задачи

getTask:
  parameters:
    - $ref: '#/parameters/taskId'
  responses:
    '200':
      description: Task details
      content:
        application/json:
          schema:
            $ref: '#/schemas/Task'
    '401':
      $ref: '../shared/responses.yaml#/UnauthorizedError'
    '404':
      $ref: '../shared/responses.yaml#/NotFoundError'

updateTask:
  parameters:
    - $ref: '#/parameters/taskId'
  requestBody:
    required: true
    content:
      application/json:
        schema:
          type: object
          properties:
            text:
              type: string
            completed:
              type: boolean

  responses:
    '200':
      description: Task updated
      content:
        application/json:
          schema:
            $ref: '#/schemas/Task'
    '400':
      $ref: '../shared/responses.yaml#/BadRequestError'
    '401':
      $ref: '../shared/responses.yaml#/UnauthorizedError'
    '404':
      $ref: '../shared/responses.yaml#/NotFoundError'

deleteTask:
  parameters:
    - $ref: '#/parameters/taskId'
  responses:
    '204':
      description: Task deleted
    '401':
      $ref: '../shared/responses.yaml#/UnauthorizedError'
    '404':
      $ref: '../shared/responses.yaml#/NotFoundError'

getAllTasks:
  parameters:
    - name: page
      in: query
      required: false
      schema:
        type: integer
        default: 1
        minimum: 1
    - name: limit
      in: query
      required: false
      schema:
        type: integer
        default: 10
        minimum: 1
        maximum: 100
    - name: search
      in: query
      required: false
      schema:
        type: string
    - name: sort
      in: query
      required: false
      schema:
        type: string
        enum: [createdAt, completed, priority]
  responses:
    '200':
      description: Paginated tasks list
      content:
        application/json:
          schema:
            $ref: '#/schemas/TasksList'
    '401':
      $ref: '../shared/responses.yaml#/UnauthorizedError'

createTask:
  requestBody:
    required: true
    content:
      application/json:
        schema:
          type: object
          required:
            - text
          properties:
            text:
              type: string
            completed:
              type: boolean
              default: false

  responses:
    '201':
      description: Task created
      content:
        application/json:
          schema:
            $ref: '#/schemas/Task'
    '400':
      $ref: '../shared/responses.yaml#/BadRequestError'
    '401':
      $ref: '../shared/responses.yaml#/UnauthorizedError'

deleteAllTasks:
  responses:
    '204':
      description: All tasks deleted
    '401':
      $ref: '../shared/responses.yaml#/UnauthorizedError'

getTasksStats:
  responses:
    '200':
      description: Tasks statistics
      content:
        application/json:
          schema:
            $ref: '#/schemas/TasksStats'
    '401':
      $ref: '../shared/responses.yaml#/UnauthorizedError'
